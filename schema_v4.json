{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "id": "v4.1.0",
    "description": "HR3 3D printer print job file schema for varying optical dose around and above channels, valves, DC's etc.",
    "type": "object",
    "properties": {
        "Header": {
            "type": "object",
            "properties": {
                "Schema version": {
                    "type": "string",
                    "default": "4.1.0",
                    "pattern": "^4\\.\\d\\.\\d$",
                    "description": "What version of the json schema to use to parse the file"
                },
                "Image directory": {
                    "type": "string",
                    "default": "slices",
                    "description": "Directory relative to the json print job file where the images are saved."
                },
                "Print under vacuum": {
                    "type": "boolean",
                    "default": false,
                    "description": "Should the printer print under vacuum?"
                },
                "Comment": {
                    "type": "string",
                    "default": "",
                    "description": "Layer comments"
                }
            },
            "additionalProperties": false,
            "required": [
                "Schema version",
                "Image directory"
            ]
        },
        "Design": {
            "type": "object",
            "properties": {
                "User": {
                    "type": "string",
                    "default": "",
                    "description": "Name of person who designed this device."
                },
                "Purpose": {
                    "type": "string",
                    "default": "",
                    "examples": [
                        "Calibration device"
                    ],
                    "description": "Information about what purpose the device is intended for."
                },
                "Description": {
                    "type": "string",
                    "default": "",
                    "examples": [
                        "Includes vertical and horizontal channels with widths varying from 1-5 px."
                    ],
                    "description": "More detailed explanation of the structure of the device."
                },
                "Resin": {
                    "type": "string",
                    "default": "",
                    "examples": [
                        "PEGDA"
                    ],
                    "description": "Resin intended for creating the device"
                },
                "3D printer": {
                    "type": "string",
                    "default": "",
                    "examples": [
                        "HR3.2"
                    ],
                    "description": "3D printer that the design what created for"
                },
                "Design file": {
                    "type": "string",
                    "default": "",
                    "examples": [
                        "my-design.scad",
                        "path/to/design/on/caedem/server/filename.scad"
                    ],
                    "description": "Name of the scad file and/or the path to where the file is saved."
                },
                "STL file": {
                    "type": "string",
                    "default": "",
                    "examples": [
                        "my-design.stl",
                        "path/to/stl/on/caedem/server/filename.stl"
                    ],
                    "description": "Name of the stl file and/or the path to where the file is saved."
                },
                "Slicer": {
                    "type": "string",
                    "default": "",
                    "examples": [
                        "Matt's web based slicer",
                        "Hua's slicer"
                    ],
                    "description": "Name of the slicer used to make the image stack."
                },
                "Date": {
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "Default layer settings": {
            "type": "object",
            "properties": {
                "Comment": {
                    "type": "string",
                    "default": "",
                    "description": "Layer comments"
                },
                "Number of duplications": {
                    "type": "integer",
                    "minimum": 1,
                    "default": 1,
                    "description": "Custom number of times to duplicate a layer"
                },
                "Position settings": {
                    "type": "object",
                    "properties": {
                        "Layer thickness (um)": {
                            "type": "number",
                            "default": 10,
                            "description": "Custom layer thickness. Can be negative only when used to compensate for a previous layer with significantly larger thickness (e.g., for membrane fabrication)."
                        },
                        "Distance up (mm)": {
                            "type": "number",
                            "exclusiveMinimum": 0,
                            "description": "Distance to move the build up after completing a layer."
                        },
                        "Initial wait (ms)": {
                            "type": "number",
                            "minimum": 0,
                            "default": 0,
                            "description": "Time to wait between exposures."
                        },
                        "BP up speed (mm/sec)": {
                            "type": "number",
                            "minimum": 0,
                            "default": 20,
                            "description": "Specify the velocity of the build platform when moving up"
                        },
                        "BP up acceleration (mm/sec^2)": {
                            "type": "number",
                            "minimum": 0,
                            "default": 20,
                            "description": "Specify the acceleration of the build platform when moving up"
                        },
                        "Up wait (ms)": {
                            "type": "number",
                            "minimum": 0,
                            "default": 0,
                            "description": "How long to wait after the build platform has been moved up to start moving back down."
                        },
                        "BP down speed (mm/sec)": {
                            "type": "number",
                            "minimum": 0,
                            "default": 20,
                            "description": "Specify the velocity of the build platform when moving down"
                        },
                        "BP down acceleration (mm/sec^2)": {
                            "type": "number",
                            "minimum": 0,
                            "default": 20,
                            "description": "Specify the acceleration of the build platform when moving down"
                        },
                        "Enable force squeeze": {
                            "type": "boolean",
                            "default": false,
                            "description": "Should the printer squeeze out resin before a layer"
                        },
                        "Squeeze count": {
                            "type": "number",
                            "minimum": 0,
                            "default": 0,
                            "description": "How many times is the printer squeezing out resin."
                        },
                        "Squeeze force (N)": {
                            "type": "number",
                            "minimum": 0,
                            "default": 40,
                            "description": "Force to squeeze with"
                        },
                        "Squeeze wait (ms)": {
                            "type": "number",
                            "minimum": 0,
                            "default": 100,
                            "description": "Time to squeeze"
                        },
                        "Final wait (ms)": {
                            "type": "number",
                            "minimum": 0,
                            "default": 0,
                            "description": "Time to wait after final exposure on a layer"
                        }
                    },
                    "additionalProperties": false,
                    "required": [
                        "Layer thickness (um)",
                        "Distance up (mm)",
                        "Initial wait (ms)",
                        "BP up speed (mm/sec)",
                        "BP up acceleration (mm/sec^2)",
                        "Up wait (ms)",
                        "BP down speed (mm/sec)",
                        "BP down acceleration (mm/sec^2)",
                        "Final wait (ms)"
                    ]
                },
                "Image settings": {
                    "type": "object",
                    "properties": {
                        "Image file": {
                            "type": "string",
                            "default": "png",
                            "description": "Default image file"
                        },
                        "Do light grayscale correction": {
                            "type": "boolean",
                            "default": false,
                            "description": "Should the printer apply a grayscale irradiance correction to the white values of this image?"
                        },
                        "Do dark grayscale correction": {
                            "type": "boolean",
                            "default": false,
                            "description": "Should the printer apply a grayscale irradiance correction to the dark values of this image?"
                        },
                        "Image x offset (um)": {
                            "type": "number",
                            "default": 0,
                            "description": "Default x position for layer."
                        },
                        "Image y offset (um)": {
                            "type": "number",
                            "default": 0,
                            "description": "Default y position for layer."
                        },
                        "Layer exposure time (ms)": {
                            "type": "number",
                            "minimum": 0,
                            "maximum": 10000,
                            "description": "Default time to expose a single image layer for."
                        },
                        "Light engine": {
                            "type": "string",
                            "default": "visitech",
                            "enum": [
                                "visitech",
                                "visitech (365nm)",
                                "visitech (405nm)",
                                "wintech"
                            ],
                            "description": "Default light engine for exposure."
                        },
                        "Light engine power setting": {
                            "type": "integer",
                            "minimum": 0,
                            "default": 100,
                            "maximum": 1000,
                            "description": "Default power to expose an image at."
                        },
                        "Relative focus position (um)": {
                            "type": "number",
                            "description": "Default realtive focus position for this layer."
                        },
                        "Wait before exposure (ms)": {
                            "type": "number",
                            "minimum": 0,
                            "description": "Wait time before exposure"
                        },
                        "Wait after exposure (ms)": {
                            "type": "number",
                            "minimum": 0,
                            "description": "Wait time after exposure"
                        }
                    },
                    "additionalProperties": false,
                    "required": [
                        "Image file",
                        "Layer exposure time (ms)",
                        "Light engine power setting",
                        "Relative focus position (um)",
                        "Wait before exposure (ms)",
                        "Wait after exposure (ms)"
                    ]
                }
            },
            "additionalProperties": false,
            "required": [
                "Number of duplications",
                "Position settings",
                "Image settings"
            ]
        },
        "Variables": {
            "type": "object",
            "additionalProperties": true
        },
        "Named position settings": {
            "type": "object",
            "additionalProperties": {
                "$ref": "#/$defs/POSITION_SETTINGS"
            }
        },
        "Named image settings": {
            "type": "object",
            "additionalProperties": {
                "$ref": "#/$defs/IMAGE_SETTINGS"
            }
        },
        "Templates": {
            "type": "object",
            "additionalProperties": {
                "type": "object",
                "properties": {
                    "Comment": {
                        "type": "string",
                        "default": "",
                        "description": "Layer comments"
                    },
                    "Parent template": {
                        "type": "string",
                        "default": "",
                        "description": "Use template as defaults for layer."
                    },
                    "Number of duplications": {
                        "type": "integer",
                        "minimum": 1,
                        "default": 1,
                        "description": "Custom number of times to duplicate a layer"
                    },
                    "Position settings": {
                        "$ref": "#/$defs/POSITION_SETTINGS"
                    },
                    "Using named default image settings": {
                        "type": "string",
                        "default": "",
                        "description": "Updates all image settings with this default"
                    },
                    "Image settings list": {
                        "type": "array",
                        "items": {
                            "$ref": "#/$defs/IMAGE_SETTINGS"
                        },
                        "additionalProperties": false
                    }
                },
                "additionalProperties": false
            }
        },
        "Layers": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "Comment": {
                        "type": "string",
                        "default": "",
                        "description": "Layer comments"
                    },
                    "Using templates": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "default": "",
                            "description": "Use templates as defaults for layer. For multiple templates: 'Image settings lists' are appended. 'Position settings' and 'Number of duplicates' must match."
                        },
                        "additionalProperties": false
                    },
                    "Number of duplications": {
                        "type": "integer",
                        "minimum": 1,
                        "default": 1,
                        "description": "Custom number of times to duplicate a layer"
                    },
                    "Position settings": {
                        "$ref": "#/$defs/POSITION_SETTINGS"
                    },
                    "Using named default image settings": {
                        "type": "string",
                        "default": "",
                        "description": "Updates all image settings with this default"
                    },
                    "Image settings list": {
                        "type": "array",
                        "items": {
                            "$ref": "#/$defs/IMAGE_SETTINGS"
                        },
                        "additionalProperties": false
                    }
                },
                "additionalProperties": false
            },
            "additionalProperties": false,
            "required": []
        },
        "additionalProperties": false
    },
    "additionalProperties": false,
    "required": [
        "Header",
        "Default layer settings"
    ],
    "$defs": {
        "POSITION_SETTINGS": {
            "type": "object",
            "properties": {
                "Using named position settings": {
                    "type": "string",
                    "default": "",
                    "description": "Use alternitive defaults for position settings"
                },
                "Layer thickness (um)": {
                    "type": "number",
                    "default": 10,
                    "description": "Custom layer thickness. Can be negative only when used to compensate for a previous layer with significantly larger thickness (e.g., for membrane fabrication)."
                },
                "Distance up (mm)": {
                    "type": "number",
                    "exclusiveMinimum": 0,
                    "description": "Distance to move the build up after completing a layer."
                },
                "Initial wait (ms)": {
                    "type": "number",
                    "minimum": 0,
                    "default": 0,
                    "description": "Time to wait between exposures."
                },
                "BP up speed (mm/sec)": {
                    "type": "number",
                    "minimum": 0,
                    "default": 20,
                    "description": "Specify the velocity of the build platform when moving up"
                },
                "BP up acceleration (mm/sec^2)": {
                    "type": "number",
                    "minimum": 0,
                    "default": 20,
                    "description": "Specify the acceleration of the build platform when moving up"
                },
                "Up wait (ms)": {
                    "type": "number",
                    "minimum": 0,
                    "default": 0,
                    "description": "How long to wait after the build platform has been moved up to start moving back down."
                },
                "BP down speed (mm/sec)": {
                    "type": "number",
                    "minimum": 0,
                    "default": 20,
                    "description": "Specify the velocity of the build platform when moving down"
                },
                "BP down acceleration (mm/sec^2)": {
                    "type": "number",
                    "minimum": 0,
                    "default": 20,
                    "description": "Specify the acceleration of the build platform when moving down"
                },
                "Enable force squeeze": {
                    "type": "boolean",
                    "default": false,
                    "description": "Should the printer squeeze out resin before a layer"
                },
                "Squeeze count": {
                    "type": "number",
                    "minimum": 0,
                    "default": 0,
                    "description": "How many times is the printer squeezing out resin."
                },
                "Squeeze force (N)": {
                    "type": "number",
                    "minimum": 0,
                    "default": 40,
                    "description": "Force to squeeze with"
                },
                "Squeeze wait (ms)": {
                    "type": "number",
                    "minimum": 0,
                    "default": 100,
                    "description": "Time to squeeze"
                },
                "Final wait (ms)": {
                    "type": "number",
                    "minimum": 0,
                    "default": 0,
                    "description": "Time to wait after final exposure on a layer"
                }
            },
            "additionalProperties": false
        },
        "IMAGE_SETTINGS": {
            "type": "object",
            "properties": {
                "Using named image settings": {
                    "type": "string",
                    "default": "",
                    "description": "Use alternitive defaults for image settings"
                },
                "Image file": {
                    "type": "string",
                    "default": "png",
                    "description": "Default image file"
                },
                "Do light grayscale correction": {
                    "type": "boolean",
                    "default": false,
                    "description": "Should the printer apply a grayscale irradiance correction to the white values of this image?"
                },
                "Do dark grayscale correction": {
                    "type": "boolean",
                    "default": false,
                    "description": "Should the printer apply a grayscale irradiance correction to the dark values of this image?"
                },
                "Image x offset (um)": {
                    "type": "number",
                    "default": 0,
                    "description": "Default x position for layer."
                },
                "Image y offset (um)": {
                    "type": "number",
                    "default": 0,
                    "description": "Default y position for layer."
                },
                "Layer exposure time (ms)": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 10000,
                    "description": "Default time to expose a single image layer for."
                },
                "Light engine": {
                    "type": "string",
                    "default": "visitech",
                    "enum": [
                        "visitech",
                        "visitech (365nm)",
                        "visitech (405nm)",
                        "wintech"
                    ],
                    "description": "Default light engine for exposure."
                },
                "Light engine power setting": {
                    "type": "integer",
                    "minimum": 0,
                    "default": 100,
                    "maximum": 1000,
                    "description": "Default power to expose an image at."
                },
                "Relative focus position (um)": {
                    "type": "number",
                    "description": "Default realtive focus position for this layer."
                },
                "Wait before exposure (ms)": {
                    "type": "number",
                    "minimum": 0,
                    "description": "Wait time before exposure"
                },
                "Wait after exposure (ms)": {
                    "type": "number",
                    "minimum": 0,
                    "description": "Wait time after exposure"
                }
            },
            "additionalProperties": false
        }
    }
}